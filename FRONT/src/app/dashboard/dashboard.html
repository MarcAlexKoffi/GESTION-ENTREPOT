<body>
  <div class="app-shell">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-logo">
        <div class="sidebar-logo-icon">
          <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M42.4379 44C42.4379 44 36.0744 33.9038 41.1692 24C46.8624 12.9336 42.2078 4 42.2078 4L7.01134 4C7.01134 4 11.6577 12.932 5.96912 23.9969C0.876273 33.9029 7.27094 44 7.27094 44L42.4379 44Z"
              fill="currentColor"
            ></path>
          </svg>
        </div>
        <h1 class="sidebar-logo-title">Entrepôts</h1>
      </div>

      <nav class="sidebar-nav">
        <a [routerLink]="'/dashboard/dashboard-main'" routerLinkActive="active" class="nav-link">
          <span class="material-symbols-outlined">dashboard</span>
          <p>Tableau de bord</p>
        </a>
        <a [routerLink]="'/dashboard/userManager'" routerLinkActive="active" class="nav-link">
          <span class="material-symbols-outlined">admin_panel_settings</span>
          <p>Users Manager</p>
        </a>
        <a [routerLink]="'/dashboard/historique'" routerLinkActive="active" class="nav-link">
          <span class="material-symbols-outlined">history</span>
          <p>Historique</p>
        </a>

        <!-- NOUVEAU : Statistique globale -->
        <a [routerLink]="'/dashboard/statistique'" routerLinkActive="active" class="nav-link">
          <span class="material-symbols-outlined">query_stats</span>
          <p>Statistique globale</p>
        </a>
      </nav>

      <div class="sidebar-footer">
        <a href="#" class="nav-link">
          <span class="material-symbols-outlined">help</span>
          <p>Aide</p>
        </a>

        <!-- NOUVEAU : Déconnexion -->
        <a href="#" class="nav-link nav-link--danger">
          <span class="material-symbols-outlined">logout</span>
          <p>Déconnexion</p>
        </a>
      </div>
    </aside>

    <!-- MAIN AREA -->
    <div class="main">
      <!-- TOP BAR -->
      <header class="topbar">
        <div class="topbar-actions">
          <!-- NOTIFICATION BUTTON -->
          <div
            class="notification-wrapper"
            style="position: relative"
            (click)="$event.stopPropagation()"
          >
            <button class="icon-button" type="button" (click)="toggleNotifications($event)">
              <span class="material-symbols-outlined">notifications</span>

              <!-- BADGE NOTIF -->
              <span *ngIf="notifCount > 0" class="notif-badge">
                {{ notifCount }}
              </span>
            </button>
            <!-- DROPDOWN -->
            <div class="notif-dropdown" *ngIf="showNotifDropdown" (click)="$event.stopPropagation()">
              <p class="notif-title">Demandes en attente</p>
              <div *ngIf="notifications.length === 0" class="notif-empty">
                Aucune demande en attente.
              </div>
              <div
                *ngFor="let n of notifications"
                class="notif-item"
                (click)="openNotification(n); $event.stopPropagation()"
              >
                <div class="notif-line-main">
                  <span class="notif-immat">{{ n.immatriculation }}</span>
                  <span class="notif-entrepot">{{ n.entrepotName }}</span>
                </div>

                <div class="notif-line-meta">
                  <span class="notif-time">Arrivé : {{ n.heureArrivee }}</span>
                </div>
              </div>
            </div>
          </div>

          <div class="user-block">
            <div
              class="user-avatar"
              style="
                background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDPHyHGMfTjg0KY3dZ-4D-csVv0_-YYCb8FAMEwxtDUIYrSr0qUlMlx9xc0kD5FdKoHfGT2TO7q3AfmgKtLEa3ZZSJssGPPp0WNOEjaBIbeeeOYdn3xAbxA5qOPiXRi5piRgZ9GB7GF8kudQYw8dkAAgGGYEsWT2DXaQ8m7QeeV5YTKpQb33QwQOQPF6tgTY0ZM5PfeTpb8NQByRdbDmwCCBSNPHz0CRZWMFIro1_4Unfqodv6iXWCL4YMw3aQxA9Y9MNpk4lnTUBoL');
              "
            ></div>

            <div class="user-info">
              <p class="user-name">Marc Alex</p>
              <p class="user-role">Administrateur</p>
            </div>

            <button class="user-toggle" type="button">
              <span class="material-symbols-outlined">expand_more</span>
            </button>
          </div>
        </div>
      </header>

      <!-- PAGE CONTENT -->
      <main class="page">
        <router-outlet></router-outlet>
      </main>
    </div>
  </div>
</body>
